<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Viewer</title>
  <style>
    body { background: #000; color: #0f0; font-family: monospace; text-align: center; }
    video { width: 100%; border: 2px solid #0f0; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>üñ•Ô∏è Screen Viewer</h2>
  <video id="remoteVideo" autoplay playsinline></video>

  <script>
    const socket = new WebSocket("wss://prototypes-le04.onrender.com");
    const video = document.getElementById("remoteVideo");

    const peer = new RTCPeerConnection();
    peer.ontrack = e => (video.srcObject = e.streams[0]);

    socket.onopen = () => console.log("Connected to signaling server");

    socket.onmessage = async e => {
      const data = JSON.parse(e.data);

      if (data.offer) {
        await peer.setRemoteDescription(new RTCSessionDescription(data.offer));
        const answer = await peer.createAnswer();
        await peer.setLocalDescription(answer);
        socket.send(JSON.stringify({ answer }));
      } else if (data.candidate) {
        await peer.addIceCandidate(new RTCIceCandidate(data.candidate));
      }
    };

    peer.onicecandidate = e => {
      if (e.candidate) socket.send(JSON.stringify({ candidate: e.candidate }));
    };
  </script>
</body>
</html>
